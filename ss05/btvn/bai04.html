<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      let booksId = [];
      let booksName = [];
      let bookStatus = [];

      const statusMap = {
        1: "Hỏng nhẹ",
        2: "Hỏng nặng",
        3: "Cần sửa gấp",
        4: "Đã sửa xong",
        5: "Loại bỏ",
      };

      let n = +prompt(
        "Có bao nhiêu cuốn sách cần kiểm tra tình trạng hôm nay? ",
      );

      for (let i = 0; i < n; i++) {
        let id;
        do {
          id = prompt(`Nhập mã sách thứ ${i + 1}:`);
        } while (!id || id.trim() === "");

        let name;
        do {
          name = prompt(`Nhập tên sách thứ ${i + 1}:`);
        } while (!name || name.trim() === "");

        let statusChoice;
        do {
          statusChoice = +prompt(
            `Nhập tình trạng ban đầu (1: Hỏng nhẹ, 2: Hỏng nặng, 3: Cần sửa gấp):`,
          );
        } while (![1, 2, 3].includes(statusChoice));

        booksId.push(id);
        booksName.push(name);
        bookStatus.push(statusMap[statusChoice]);
      }

      function printList() {
        console.log("Danh sách hiện tại:");
        for (let i = 0; i < booksId.length; i++) {
          console.log(
            `${i + 1}. Mã sách: ${booksId[i]} | Tên sách: ${booksName[i]} | Tình trạng: ${bookStatus[i]}`,
          );
        }
      }

      printList();

      let choice;
      do {
        choice = +prompt(
          "Bạn muốn làm gì? (1: Sửa tình trạng, 2: Loại bỏ, 0: Kết thúc)",
        );
        if (choice === 1) {
          let idEdit = prompt("Nhập mã sách cần sửa:");
          let foundIndex = -1;
          for (let i = 0; i < booksId.length; i++) {
            if (booksId[i] === idEdit) {
              foundIndex = i;
              break;
            }
          }
          if (foundIndex !== -1) {
            let newStatus;
            do {
              newStatus = +prompt(
                "Chọn tình trạng mới (1: Hỏng nhẹ, 2: Hỏng nặng, 3: Cần sửa gấp, 4: Đã sửa xong, 5: Loại bỏ):",
              );
            } while (![1, 2, 3, 4, 5].includes(newStatus));
            bookStatus[foundIndex] = statusMap[newStatus];
            console.log("Đã cập nhật tình trạng sách.");
          } else {
            console.log("Không tìm thấy mã sách.");
          }
          printList();
        } else if (choice === 2) {
          let idDelete = prompt("Nhập mã sách cần xóa:");
          let foundIndex = -1;
          for (let i = 0; i < booksId.length; i++) {
            if (booksId[i] === idDelete) {
              foundIndex = i;
              break;
            }
          }
          if (foundIndex !== -1) {
            booksId.splice(foundIndex, 1);
            booksName.splice(foundIndex, 1);
            bookStatus.splice(foundIndex, 1);
            console.log("Đã xóa sách khỏi danh sách.");
          } else {
            console.log("Không tìm thấy mã sách.");
          }
          printList();
        }
      } while (choice !== 0);

      console.log("=== BÁO CÁO CUỐI ===");
      console.log("Tổng số sách còn lại:", booksId.length);

      let countRepaired = 0;
      let countRemoved = 0;
      for (let status of bookStatus) {
        if (status === "Đã sửa xong") countRepaired++;
        if (status === "Loại bỏ") countRemoved++;
      }
      console.log("Số sách đã sửa xong:", countRepaired);
      console.log("Số sách loại bỏ:", countRemoved);

      if (booksId.length > 0) {
        console.log("Danh sách các sách còn lại:");
        printList();
      } else {
        console.log("Không còn sách nào trong danh sách.");
      }
    </script>
  </body>
</html>
